from enum import Enum


class Week(Enum):

    Monday = 1
    Tuesday = 2
    Wednesday = 3
    Thursday = 4
    Friday = 5
    Saturday = 6
    Sunday = 7


class MarketOperationStatus(Enum):

    Open = 0
    Close = 1


class TradingHour(Enum):

    new_day = 0  # 00:00 - 08:45
    pre_open = 1  # 08:45 - 09:00
    market_open_before_lunch = 2  # 09:00 - 12:30
    break_hour = 3  # 12:30 - 14:30
    market_open_after_lunch = 4  # 14:30 - 16:00
    margin_call = 5  # 16:00 - 16:50
    last_call = 6  # 16:50 - 17:00
    data_udpate = 7  # 17:00 - 17:30
    market_close = 8  # 17:30 - 00:00


class PublicHoliday:

    # Marking down public holiday year-month-date
    year_1994 = ['19940201', '19940209', '19940210', '19940211', '19940314',
                 '19940315', '19940316', '19940502', '19940525', '19940831',
                 '19941102', '19941226']
    year_1995 = ['19950102', '19950130', '19950131', '19950201', '19950202',
                 '19950301', '19950302', '19950303', '19950425', '19950501',
                 '19950510', '19950515', '19950531', '19950809', '19950831',
                 '19951023', '19951225']
    year_1996 = ['19960101', '19960201', '19960219', '19960220', '19960221',
                 '19960222', '19960223', '19960429', '19960501', '19960520',
                 '19960531', '19960729', '19961111', '19961225']
    year_1997 = ['19970101', '19970206', '19970207', '19970210', '19970211',
                 '19970418', '19970501', '19970508', '19970521', '19970717',
                 '19970901', '19971030', '19971225']
    year_1998 = ['19980101', '19980127', '19980128', '19980129', '19980130',
                 '19980202', '19980407', '19980428', '19980501', '19980511',
                 '19980706', '19980831', '19980928', '19981019', '19981224',
                 '19981225']
    year_1999 = ['19990101', '19990118', '19990119', '19990120', '19990201',
                 '19990215', '19990216', '19990217', '19990329', '19990527',
                 '19990831', '19991108', '19991129', '19991231']
    year_2000 = ['20000107', '20000110', '20000201', '20000204', '20000207',
                 '20000316', '20000406', '20000501', '20000518', '20000601',
                 '20000615', '20000831', '20001026', '20001225', '20001227',
                 '20001228', '20001229']
    year_2001 = ['20010101', '20010123', '20010124', '20010125', '20010201',
                 '20010306', '20010326', '20010501', '20010507', '20010604',
                 '20010831', '20010912', '20011114', '20011122', '20011217',
                 '20011218', '20011219', '20011225']
    year_2002 = ['20020101', '20020201', '20020211', '20020212', '20020213',
                 '20020315', '20020425', '20020501', '20020527', '20021104',
                 '20021205', '20021206', '20021225']
    year_2003 = ['20030101', '20030131', '20030203', '20030204', '20030212',
                 '20030304', '20030501', '20030514', '20030515', '20030901',
                 '20031024', '20031124', '20031125', '20031126', '20031225']
    year_2004 = ['20040101', '20040121', '20040122', '20040123', '20040202',
                 '20040203', '20040223', '20040503', '20040504', '20040831',
                 '20041111', '20041112', '20041115', '20041116']
    year_2005 = ['20050121', '20050201', '20050209', '20050210', '20050211',
                 '20050421', '20050502', '20050523', '20050831', '20051101',
                 '20051103', '20051104', '20051226']
    year_2006 = ['20060102', '20060110', '20060130', '20060131', '20060201',
                 '20060202', '20060411', '20060501', '20060512', '20060831',
                 '20061023', '20061024', '20061025', '20061225']
    year_2007 = ['20070101', '20070102', '20070201', '20070219', '20070220',
                 '20070426', '20070501', '20070502', '20070831', '20071015',
                 '20071108', '20071220', '20071225']
    year_2008 = ['20080101', '20080110', '20080123', '20080201', '20080207',
                 '20080208', '20080320', '20080501', '20080519', '20081001',
                 '20081002', '20081027', '20081208', '20081225', '20081229']
    year_2009 = ['20090101', '20090126', '20090127', '20090202', '20090209',
                 '20090309', '20090501', '20090831', '20090921', '20090922',
                 '20091127', '20091218', '20091225']
    year_2010 = ['20100101', '20100201', '20100215', '20100216', '20100226',
                 '20100528', '20100831', '20100910', '20100916', '20101105',
                 '20101117', '20101207', '20101231']
    year_2011 = ['20110120', '20110201', '20110203', '20110204', '20110215',
                 '20110502', '20110517', '20110830', '20110831', '20110901',
                 '20110916', '20111026', '20111107', '20111128', '20111226']
    year_2012 = ['20120102', '20120123', '20120124', '20120201', '20120206',
                 '20120207', '20120411', '20120501', '20120820', '20120821',
                 '20120831', '20120917', '20121026', '20121113', '20121115',
                 '20121225']
    year_2013 = ['20130101', '20130124', '20130128', '20130201', '20130211',
                 '20130212', '20130501', '20130524', '20130808', '20130809',
                 '20130916', '20131015', '20131105', '20131225']
    year_2014 = ['20140101', '20140114', '20140117', '20140131', '20140203',
                 '20140501', '20140513', '20140715', '20140728', '20140729',
                 '20140901', '20140916', '20141006', '20141022', '20141225']
    year_2015 = ['20150101', '20150202', '20150203', '20150219', '20150220',
                 '20150501', '20150504', '20150717', '20150831', '20150916',
                 '20150924', '20151014', '20151110', '20151224', '20151225']
    year_2016 = ['20160101', '20160125', '20160201', '20160208', '20160209',
                 '20160502', '20160622', '20160706', '20160707', '20160831',
                 '20160912', '20160916', '20161003', '20161212', '20161226']
    year_2017 = ['20170102', '20170130', '20170201', '20170209', '20170424',
                 '20170501', '20170510', '20170612', '20170626', '20170627',
                 '20170831', '20170901', '20170904', '20170922', '20171018',
                 '20171201', '20171225']
    year_2018 = ['20180101', '20180131', '20180201', '20180216', '20180501',
                 '20180509', '20180510', '20180511', '20180529', '20180615',
                 '20180822', '20180831', '20180910', '20180911', '20180917',
                 '20181106', '20181120', '20181225']
    year_2019 = ['20190101', '20190121', '20190201', '20190205', '20190206',
                 '20190501', '20190520', '20190522', '20190605', '20190606',
                 '20190730', '20190812', '20190902', '20190909', '20190916',
                 '20191028', '20191225']
    year_2020 = []

    years = year_1994 + \
        year_1995 + year_1996 + year_1997 + year_1998 + year_1999 + \
        year_2000 + year_2001 + year_2002 + year_2003 + year_2004 + \
        year_2005 + year_2006 + year_2007 + year_2008 + year_2009 + \
        year_2010 + year_2011 + year_2012 + year_2013 + year_2014 + \
        year_2015 + year_2016 + year_2017 + year_2018 + year_2019 + \
        year_2020


class MarketOperation:

    @staticmethod
    def check_holiday(date):
        """ To check given date it is a public holiday.
        Keyword Arguments:
            date [class] -- Datetime.date class
        Raises:
            None
        Returns:
            True -- It is a public holiday.
            False -- It is not a public holiday.
        """
        date = date.strftime('%Y%m%d')
        return True if date in PublicHoliday().years else False

    @staticmethod
    def check_weekend(date):
        """ To check given date it is a weekend.
        Keyword Arguments:
            date [class] -- Datetime.date class
        Raises:
            None
        Returns:
            True -- It is a weekend.
            False -- It is not a weekend.
        """
        weekend = [Week.Saturday.value,
                   Week.Sunday.value]

        return True if date.isoweekday() in weekend else False

    @staticmethod
    def getOperatingStatus(date):
        """ Return market operating status based on given date.
        Keyword Arguments:
            date [class] -- Datetime.date class
        Raises:
            None
        Returns:
            status [str] -- Either close or open
        """

        is_holiday = __class__().check_holiday(date)
        is_weekend = __class__().check_weekend(date)

        if is_holiday or is_weekend:
            status = MarketOperationStatus.Close.name
        else:
            status = MarketOperationStatus.Open.name

        return status


if __name__ == '__main__':
    pass
